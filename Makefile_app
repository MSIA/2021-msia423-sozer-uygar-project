imagename = cuisinehelpr
datafolder = data/

rds_route = "mysql+pymysql://msia423instructor:usz2807@msia423db.cxnolz9olxpr.us-east-1.rds.amazonaws.com:3306/msia423db"

image:
	docker build -t $(imagename) .

data/raw.json:
	python3 run.py download --s3path="s3://2021-msia423-sozer-uygar/raw.json" --path_to="data/raw.json"

raw: data/raw.json

data/clean.csv: data/raw.json config/config.yaml
	python3 run.py pipeline clean --input=data/raw.json --config=config/config.yaml --output=data/clean.csv

cleaned: data/clean.csv

data/full.csv: data/clean.csv config/config.yaml
	python3 run.py pipeline features --input=data/clean.csv --config=config/config.yaml --output=data/full.csv

features: data/full.csv

reset:
	rm data/*

model: data/raw.json config/config.yaml
	python3 run.py pipeline model --input=data/raw.json --config=config/config.yaml --output=data/

data/kitchen.db: data/full.csv config/config.yaml
	python3 run.py create 

localdb: data/kitchen.db

test:
	python3 -m pytest

app: data/full.csv
	python3 app.py

all: data/raw.json data/clean.csv data/full.csv model

.PHONY: image raw cleaned features reset test model localdb all app